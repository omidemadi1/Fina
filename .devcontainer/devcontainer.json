{
  "name": "Fina Workspaces",
  "build": {
    "dockerfile": "Dockerfile"
  },

  // Important React Native ports
  "forwardPorts": [8081, 19000, 19001, 19002, 19006, 8097],

  // mount code + caches + separate node_modules
  "mounts": [
    "source=${localWorkspaceFolder},target=/workspaces/${localWorkspaceFolderBasename},type=bind",
    "source=${localWorkspaceFolderBasename}-node-modules,target=/workspaces/${localWorkspaceFolderBasename}/node_modules,type=volume",
    "source=${localWorkspaceFolderBasename}-android,target=/workspaces/${localWorkspaceFolderBasename}/android,type=volume",
    "source=${localWorkspaceFolderBasename}-cache,target=/home/node/.cache,type=volume"
  ],

  //Run after the container is created
  "postCreateCommand": "npm install --foreground-scripts && corepack enable",

  //Non-root user (more secure)
  "remoteUser": "node",

  // VS Code extensions
  "customizations": {
    "vscode": {
      "extensions": [
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode",
        "ms-vscode.vscode-react-native",
        "msjsdiag.debugger-for-chrome",
        "GitHub.copilot",
        "eamodio.gitlens"
      ],
      "settings": {
        "terminal.integrated.defaultProfile.linux": "bash",
        "react-native.packager.port": 8081
      }
    }
  },

  // Maximum security (even if someone gets root inside the container)
  "runArgs": [
    "--security-opt=no-new-privileges:true",
    "--cap-drop=ALL",
    "--cap-add=NET_BIND_SERVICE"
  ],

  // For accessing real Android device or emulator via adb
  "containerEnv": {
    "ADB_SERVER_SOCKET": "tcp:host.docker.internal:5037"
  }
}